<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>ass</title>
		<style>
			html, body {
				margin: 0;
				padding: 0;
				height: 100%;
			}
			#map-container {
				width: 100vw;
				height: 100vh;
				display: block;
			}
			#tooltip {
				position: absolute;
				background: rgba(0,0,0,0.7);
				color: #fff;
				padding: 4px 8px;
				border-radius: 4px;
				pointer-events: none;
				font-size: 14px;
				display: none;
				z-index: 10;
			}
			.highlight {
				stroke: red;
				stroke-width: 2;
				fill-opacity: 0.3;
				cursor: pointer;
				transition: all 0.2s;
			}
		</style>
	</head>
	<body>
		<div id="map-container"></div>
		<div id="tooltip"></div>
		<script>
			async function loadMap() {
				try
				{
					const res = await fetch("http://localhost:5221/map/world");
					const svgText = await res.text();
					
					const container = document.getElementById("map-container");
					container.innerHTML = svgText;
					
					const svg = container.querySelector("svg");
					if (svg)
					{
						svg.setAttribute("width", "100%");
						svg.setAttribute("height", "100%");
						svg.setAttribute("preserveAspectRatio", "xMidYMid meet");
					}
					
					const tooltip = document.getElementById("tooltip");
					console.log(tooltip);
					const paths = svg.querySelectorAll("path");				
					const countries = {};
					paths.forEach(path => 
					{
						const name = path.getAttribute("name") || path.getAttribute("class")
						
						path.addEventListener("mouseenter", (e) => 
						{
							path.classList.add("highlight");
							tooltip.textContent = name;
							tooltip.style.display = "block";
						});

						path.addEventListener("mousemove", (e) =>
						{
							tooltip.style.left = e.pageX + 10 + "px";
							tooltip.style.top = e.pageY + 10 + "px";
						});

						path.addEventListener("mouseleave", () => 
						{
							path.classList.remove("highlight");
							tooltip.style.display = "none";
						});

						if (!countries[name])
						{
							countries[name] = [];
						}
						
						countries[name].push(path);
					});
					
					console.log(countries);
				}
				catch (error)
				{
					console.error("Failed to load map: ", error);
				}
			}		
			loadMap();
		</script>
	</body>
</html>